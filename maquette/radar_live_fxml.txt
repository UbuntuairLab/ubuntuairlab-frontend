<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.text.Font?>

<StackPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.example.ModuleRadarLiveController"
           prefHeight="884.0" prefWidth="480.0" styleClass="root">
    
    <!-- Map Background -->
    <ImageView fitHeight="884.0" fitWidth="480.0" preserveRatio="false">
        <image>
            <Image url="@images/heathrow_satellite.jpg"/>
        </image>
    </ImageView>
    
    <!-- Main Container -->
    <VBox alignment="TOP_CENTER" spacing="0">
        
        <!-- Top App Bar -->
        <HBox alignment="CENTER" styleClass="app-bar" prefHeight="64.0">
            <padding>
                <Insets top="16" right="16" bottom="8" left="16"/>
            </padding>
            
            <Button styleClass="icon-button-light" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                <graphic>
                    <Label text="←" styleClass="icon-label-light"/>
                </graphic>
            </Button>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Label text="Module Radar Live" styleClass="app-title">
                <font>
                    <Font name="Inter Bold" size="18"/>
                </font>
            </Label>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Button styleClass="icon-button-light" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                <graphic>
                    <Label text="☰" styleClass="icon-label-light"/>
                </graphic>
            </Button>
        </HBox>
        
        <Region VBox.vgrow="ALWAYS"/>
        
        <!-- Bottom Sheet -->
        <VBox styleClass="bottom-sheet" prefHeight="528.0" maxHeight="528.0">
            
            <!-- Drag Handle -->
            <HBox alignment="CENTER" prefHeight="20.0">
                <Region styleClass="drag-handle" prefWidth="36.0" prefHeight="4.0"/>
            </HBox>
            
            <!-- Content Container -->
            <VBox styleClass="bottom-sheet-content" VBox.vgrow="ALWAYS">
                
                <!-- Header -->
                <Label text="Active Flights" styleClass="section-title">
                    <padding>
                        <Insets top="12" right="16" bottom="12" left="16"/>
                    </padding>
                    <font>
                        <Font name="Inter Bold" size="22"/>
                    </font>
                </Label>
                
                <!-- Flight List (Scrollable) -->
                <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="flight-list">
                    <VBox spacing="0">
                        
                        <!-- Flight Item 1 -->
                        <HBox alignment="CENTER_LEFT" spacing="16" styleClass="flight-item">
                            <padding>
                                <Insets top="8" right="16" bottom="8" left="16"/>
                            </padding>
                            
                            <StackPane styleClass="flight-icon-container" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                                <Label text="✈" styleClass="flight-icon" rotate="-45"/>
                            </StackPane>
                            
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label text="BA2490" styleClass="flight-number">
                                    <font>
                                        <Font name="Inter Medium" size="16"/>
                                    </font>
                                </Label>
                                <Label text="A320 - London" styleClass="flight-details">
                                    <font>
                                        <Font name="Inter" size="14"/>
                                    </font>
                                </Label>
                            </VBox>
                            
                            <Label text="Arriving 5m" styleClass="flight-status">
                                <font>
                                    <Font name="Inter" size="16"/>
                                </font>
                            </Label>
                        </HBox>
                        
                        <!-- Flight Item 2 -->
                        <HBox alignment="CENTER_LEFT" spacing="16" styleClass="flight-item">
                            <padding>
                                <Insets top="8" right="16" bottom="8" left="16"/>
                            </padding>
                            
                            <StackPane styleClass="flight-icon-container" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                                <Label text="✈" styleClass="flight-icon" rotate="45"/>
                            </StackPane>
                            
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label text="LH992" styleClass="flight-number">
                                    <font>
                                        <Font name="Inter Medium" size="16"/>
                                    </font>
                                </Label>
                                <Label text="A380 - Frankfurt" styleClass="flight-details">
                                    <font>
                                        <Font name="Inter" size="14"/>
                                    </font>
                                </Label>
                            </VBox>
                            
                            <Label text="Departing 12m" styleClass="flight-status">
                                <font>
                                    <Font name="Inter" size="16"/>
                                </font>
                            </Label>
                        </HBox>
                        
                        <!-- Flight Item 3 -->
                        <HBox alignment="CENTER_LEFT" spacing="16" styleClass="flight-item">
                            <padding>
                                <Insets top="8" right="16" bottom="8" left="16"/>
                            </padding>
                            
                            <StackPane styleClass="flight-icon-container" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                                <Label text="P" styleClass="flight-icon"/>
                            </StackPane>
                            
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label text="EK204" styleClass="flight-number">
                                    <font>
                                        <Font name="Inter Medium" size="16"/>
                                    </font>
                                </Label>
                                <Label text="B777 - Dubai" styleClass="flight-details">
                                    <font>
                                        <Font name="Inter" size="14"/>
                                    </font>
                                </Label>
                            </VBox>
                            
                            <Label text="Parked at F11" styleClass="flight-status">
                                <font>
                                    <Font name="Inter" size="16"/>
                                </font>
                            </Label>
                        </HBox>
                        
                        <!-- Flight Item 4 -->
                        <HBox alignment="CENTER_LEFT" spacing="16" styleClass="flight-item">
                            <padding>
                                <Insets top="8" right="16" bottom="8" left="16"/>
                            </padding>
                            
                            <StackPane styleClass="flight-icon-container" minWidth="48" minHeight="48" maxWidth="48" maxHeight="48">
                                <Label text="✈" styleClass="flight-icon" rotate="-45"/>
                            </StackPane>
                            
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label text="DL109" styleClass="flight-number">
                                    <font>
                                        <Font name="Inter Medium" size="16"/>
                                    </font>
                                </Label>
                                <Label text="A350 - Atlanta" styleClass="flight-details">
                                    <font>
                                        <Font name="Inter" size="14"/>
                                    </font>
                                </Label>
                            </VBox>
                            
                            <Label text="Delayed 20m" styleClass="flight-status-warning">
                                <font>
                                    <Font name="Inter" size="16"/>
                                </font>
                            </Label>
                        </HBox>
                        
                    </VBox>
                </ScrollPane>
                
                <!-- Playback Controls -->
                <HBox alignment="CENTER" spacing="16" styleClass="playback-controls">
                    <padding>
                        <Insets top="12" right="16" bottom="12" left="16"/>
                    </padding>
                    
                    <Button text="❚❚" styleClass="pause-button" prefHeight="48.0" HBox.hgrow="SOMETIMES"/>
                    
                    <Button styleClass="live-button" prefHeight="48.0" HBox.hgrow="ALWAYS">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <StackPane>
                                    <Circle radius="4" styleClass="pulse-outer"/>
                                    <Circle radius="4" styleClass="pulse-inner"/>
                                </StackPane>
                                <Label text="Live" styleClass="live-label">
                                    <font>
                                        <Font name="Inter Medium" size="16"/>
                                    </font>
                                </Label>
                            </HBox>
                        </graphic>
                    </Button>
                </HBox>
                
            </VBox>
        </VBox>
    </VBox>
    
    <!-- Map UI Controls (Overlaid) -->
    <VBox alignment="CENTER_RIGHT" StackPane.alignment="CENTER_RIGHT">
        <padding>
            <Insets right="16"/>
        </padding>
        
        <VBox spacing="0" styleClass="map-controls">
            <Button styleClass="map-control-button" minWidth="40" minHeight="40" maxWidth="40" maxHeight="40">
                <graphic>
                    <Label text="+" styleClass="control-icon"/>
                </graphic>
            </Button>
            <Button styleClass="map-control-button" minWidth="40" minHeight="40" maxWidth="40" maxHeight="40">
                <graphic>
                    <Label text="−" styleClass="control-icon"/>
                </graphic>
            </Button>
        </VBox>
        
        <Region minHeight="12"/>
        
        <Button styleClass="map-control-button-single" minWidth="40" minHeight="40" maxWidth="40" maxHeight="40">
            <graphic>
                <Label text="⊙" styleClass="control-icon"/>
            </graphic>
        </Button>
    </VBox>
    
    <!-- Flight Info Popup (Overlaid) -->
    <VBox styleClass="flight-popup" maxWidth="224" StackPane.alignment="TOP_CENTER">
        <StackPane.margin>
            <Insets top="200"/>
        </StackPane.margin>
        <padding>
            <Insets top="12" right="12" bottom="12" left="12"/>
        </padding>
        
        <HBox alignment="CENTER_LEFT" spacing="8">
            <Label text="UA901" styleClass="popup-flight-number">
                <font>
                    <Font name="Inter Bold" size="18"/>
                </font>
            </Label>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="On Approach" styleClass="popup-badge">
                <padding>
                    <Insets top="2" right="8" bottom="2" left="8"/>
                </padding>
                <font>
                    <Font name="Inter Medium" size="12"/>
                </font>
            </Label>
        </HBox>
        
        <VBox spacing="4">
            <VBox.margin>
                <Insets top="8"/>
            </VBox.margin>
            <Label text="Boeing 777" styleClass="popup-detail">
                <font>
                    <Font name="Inter" size="14"/>
                </font>
            </Label>
            <Label text="ETA: 14:32 (in 8m)" styleClass="popup-detail">
                <font>
                    <Font name="Inter" size="14"/>
                </font>
            </Label>
            <Label text="Assigned: Spot G23" styleClass="popup-detail">
                <font>
                    <Font name="Inter" size="14"/>
                </font>
            </Label>
        </VBox>
    </VBox>
    
</StackPane>